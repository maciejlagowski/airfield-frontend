<ng-template #content let-modal>
  <div class="modal-body">
    <div class="modal-header">
      <h4 class="modal-title" id="modal-basic-title">Profile update</h4>
      <button (click)="modal.dismiss()" aria-label="Close" class="close" type="button">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <label *ngIf="loggedUser.isEmployee">New user  <!-- TODO some another way? -->
      <input type="checkbox" name="userType" [(ngModel)]="isNewUser"/>
    </label>

    <form #reservationForm="ngForm">
      <div class="form-group">
        <label for="startTime">Start Time</label>
        <input #startTime="ngModel" [(ngModel)]="reservation.startTime" class="form-control" id="startTime"
               name="startTime"
               placeholder="Enter start time" required type="time"/>
        <div *ngIf="startTime.pristine" class="alert alert-danger">Start time is required</div>
      </div>
      <div class="form-group">
        <label for="endTime">End Time</label>
        <input #endTime="ngModel" [(ngModel)]="reservation.endTime" class="form-control" id="endTime" name="endTime"
               placeholder="Enter end time" required type="time"/>
        <div *ngIf="endTime.pristine" class="alert alert-danger">End time is required</div>
      </div>
      <div *ngIf="getTimeDifference() < 0" class="alert alert-danger">End time cannot be earlier than start time</div>
      <div *ngIf="isHoursConflictExists()" class="alert alert-danger">Requested time is already reserved</div>
      <div *ngIf="getTimeDifference() < 30 && getTimeDifference() >= 0" class="alert alert-danger">Time period cannot be
        less than 30 minutes
      </div>
      <div class="form-group" *ngIf="isNewUser && loggedUser.isEmployee">
        Create new user
        <app-user-form></app-user-form>
      </div>
      <div class="form-group" *ngIf="!isNewUser && loggedUser.isEmployee">
        <app-user-list (userEvent)="setUser($event)"></app-user-list>
      </div>
      <p *ngIf="user!==undefined">Selected user: {{user.name}}</p>
      <div *ngIf="user === undefined && loggedUser.isEmployee" class="alert alert-danger">You must choose user</div>
      <div class="form-group">
        <label> Type of reservation
          <select [(ngModel)]="reservationType" name="reservationType">
            <option *ngFor="let type of reservationTypes">{{type}}</option>
          </select>
        </label>
      </div>
      <div *ngIf="reservationType === undefined" class="alert alert-danger">You must choose type of reservation</div>
      <button type="submit"
              [disabled]="!reservationForm.form.valid || isHoursConflictExists() ||
               (getTimeDifference() < 30 && getTimeDifference() > 0) ||
               (user === undefined && this.loggedUser.isEmployee) ||
               (reservationType === undefined)"
              class="btn btn-info" (click)="onSubmit();modal.close('Save click')">Submit
      </button>
    </form>
  </div>
</ng-template>

<button (click)="open(content)" class="btn btn-lg btn-outline-primary mr-5 mt-1 float-right">Add reservation</button>
